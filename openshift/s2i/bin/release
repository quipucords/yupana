#!/bin/bash -e
#
# S2I assemble script for the 'yupana-centos7' image.
# The 'assemble' script builds your application source so that it is ready to run.
#
# For more information refer to the documentation:
#	https://github.com/openshift/source-to-image/blob/master/docs/builder_image.md
#

# check if a version has been specified

echo "-----> BEFORE THE BUILD VERSION."
if [[ -z "${BUILD_VERSION}" ]]; then
  echo "--> Writing the release version."
  echo "-->Build version: ${BUILD_VERSION}."
  APP_HOME=${APP_HOME:-.}
  echo "$APP_HOME"
  # Look for 'release.py' in the directory specified by APP_HOME, or the current directory
  ls -l $APP_HOME
  release_file=$APP_HOME/release.py
  if [[ -f "$release_file" ]]; then
    sh "/usr/bin/sed -h"
    sh "sed -h"
    sh "sed s/BUILD_VERSION_PLACEHOLDER/1.0.0/ $release_file"
  fi
fi